package rt.vertx.server.intercept

import org.eclipse.xtend.lib.annotations.Accessors

class GoogleJwtProvider implements JwtProvider {
	//TODO: configs shouldn't be hard coded...
	
	@Accessors val audience = '61929327789-7an73tpqqk1rrt2veopv1brsfcoetmrj.apps.googleusercontent.com'
	@Accessors val issuer = 'accounts.google.com'
	
	//available at: https://www.googleapis.com/oauth2/v1/certs
	val pubKeys = #{
		"2593971cc4a211ef0c706fc3d808580b1b9e5420" -> "-----BEGIN CERTIFICATE-----\nMIIDJjCCAg6gAwIBAgIIC4cQv5E3aAQwDQYJKoZIhvcNAQEFBQAwNjE0MDIGA1UE\nAxMrZmVkZXJhdGVkLXNpZ25vbi5zeXN0ZW0uZ3NlcnZpY2VhY2NvdW50LmNvbTAe\nFw0xNjA5MDQxMTQzMzRaFw0xNjA5MDcxMjEzMzRaMDYxNDAyBgNVBAMTK2ZlZGVy\nYXRlZC1zaWdub24uc3lzdGVtLmdzZXJ2aWNlYWNjb3VudC5jb20wggEiMA0GCSqG\nSIb3DQEBAQUAA4IBDwAwggEKAoIBAQC7pvR+k0yBuFrZssBH4nzj2WtkBsm2MBj5\njMWgaElj3hlzGbWdUNvvvBhAaDib8tosnq2k1F5jG0M+9aHDrjS51bz+HHCZyAn/\nt3v2eELS22+xsqRN1SKKNfen2XgWfiV7id0480NEcCXhQjnq7HpWL/aSaoxZjGbG\n4ZP9sp9yJX/LKiYFwPQVZ4rk3kzydr9b0Dq587UL93DEBG/qjq0vmyHeE/p4lHo9\nWoChZNuzu/bdLa2VwzscKvH1hHse/XjTZBm+At16rql4HM5stWLFfoBTANM8HpVR\n63O3sMrHdjbSsNfnz+OeslY6/zSw4+/ngWWlboKdRKOqenFa4K15AgMBAAGjODA2\nMAwGA1UdEwEB/wQCMAAwDgYDVR0PAQH/BAQDAgeAMBYGA1UdJQEB/wQMMAoGCCsG\nAQUFBwMCMA0GCSqGSIb3DQEBBQUAA4IBAQALZ4xzAm0Yf6i6xFEWemZ5oEcEiAkr\nMBczfKHAOl5oxnoKv24jkd5rlZmm1IlF3jsRluUzC1ljnyFi10OBfZ78hzTIM03k\ndpEdMo2G+Ur3B6ysrjnrsMJJ1KMuLpTIIMblVTvL/RMbbOkIjTqk6vmy8bSLd/y2\nGnLjZ3mHrQu8v8hZ71n2GEFPuh+EvyjMUrZjM7MM6uuWZmUUaVeJee9Z6WyAbg4i\nZnCRbw8z+mS2AqfBk04XWK2JFtKtCrK/mOs+kIUz6hcnhk8xDR16KkwfBr9U4mYG\n1St73gpJaEvyIcoPjblR8CpIfZcT3AuRJOBN9LjC3+QiDmwUaw6sM/2L\n-----END CERTIFICATE-----\n",
		"078968a3c05b3ddcc141d36a94a116a5be4fdbe7" -> "-----BEGIN CERTIFICATE-----\nMIIDJjCCAg6gAwIBAgIILdmt1ZM/LFQwDQYJKoZIhvcNAQEFBQAwNjE0MDIGA1UE\nAxMrZmVkZXJhdGVkLXNpZ25vbi5zeXN0ZW0uZ3NlcnZpY2VhY2NvdW50LmNvbTAe\nFw0xNjA5MDUxMTQzMzRaFw0xNjA5MDgxMjEzMzRaMDYxNDAyBgNVBAMTK2ZlZGVy\nYXRlZC1zaWdub24uc3lzdGVtLmdzZXJ2aWNlYWNjb3VudC5jb20wggEiMA0GCSqG\nSIb3DQEBAQUAA4IBDwAwggEKAoIBAQCnDGQUSaul/vBh8buBGf+Vh3C+x2+iPj95\nJoWSj6sEAyBza32YmqPTSOuwvwe5y+5crPcjyfY7oHebhahYyHO47Z/K6ralD8fV\n1r4/kabfhxy5FvCfpD4XJXyhP445bsi5DSnv0J1mW5jpoQMFa2YYPSwhT577Bo4W\nzwONmrph0CE+V9GXKzngCtlsVuh3HaqXnyrFXqJvM4ttez9GdOzJDpT7m6EYJoHT\nR3vwuoceq7qS2ScqLnLQQ4mccCikjx3bvcyEnAnWL+1Opa9fbzXZE2tI/3YfkJiM\nbZjlff0XSJWv81tnQbgEh5w5BMu4thObA96tJIsyf1iQY3XxROxTAgMBAAGjODA2\nMAwGA1UdEwEB/wQCMAAwDgYDVR0PAQH/BAQDAgeAMBYGA1UdJQEB/wQMMAoGCCsG\nAQUFBwMCMA0GCSqGSIb3DQEBBQUAA4IBAQADUd9b8Doxv8J5k0auecG2OyM3jIz6\n0KsV9a5TcuvMjb9rrLgJ/FMnsawcpsHXp5/vxd5KEbIJJUyOKBJArGjQNiipOtR6\n9GM5GCsyxptxpkv0iyWFqVbey7sBPYDZBtFRAQjNp4kZKKcJMbkib5rlcoVfYvQw\nMpHEegAOeYa36HHIWePs7ZEs8Lu1Am/UKqjyM7f3x5thhqkCK5kCp3zzT0rMYtFI\ngddUDKsMgiQpyTrwPa8XbrF1ftF5TeGpn0j8MOoBe4+w0/zotEBBMga1JuUiZBZB\nY/7OrFYAbViHHmfoySrXuIjkuHM2W66Q6yIPs4Y9+/i2YBMNt2fzbkvi\n-----END CERTIFICATE-----\n",
		"cf398691c94c6ce87fed356d9c03371ec2a4ca29" -> "-----BEGIN CERTIFICATE-----\nMIIDJjCCAg6gAwIBAgIIREEAd+o4hJQwDQYJKoZIhvcNAQEFBQAwNjE0MDIGA1UE\nAxMrZmVkZXJhdGVkLXNpZ25vbi5zeXN0ZW0uZ3NlcnZpY2VhY2NvdW50LmNvbTAe\nFw0xNjA5MDMxMTQzMzRaFw0xNjA5MDYxMjEzMzRaMDYxNDAyBgNVBAMTK2ZlZGVy\nYXRlZC1zaWdub24uc3lzdGVtLmdzZXJ2aWNlYWNjb3VudC5jb20wggEiMA0GCSqG\nSIb3DQEBAQUAA4IBDwAwggEKAoIBAQDNp36/GxxMItIUkRkxLL0P8fH0WOdJI0TB\nJ3CNR7uKXO5u1ZJYp/YiKszf5zgeBgZ1ElNGjT/90nKBHKINvjn55sByRNaxV7g3\n9U6EMNkaocNxwf5gH5oSKorB2wkszXRj3+kOViJ3YBh2ZxUdUWhb3S8P+QqNoSsB\nd99r2zPuQ5RcIRC4oeeNdOQ88Ba/21dKMQDtRggfaysH6GRQQBxsgv6AYtL5T0U6\nL4olpsEYi3d0Y/5k3sZLzrMCDVna4tihSffT6gJIeDJBPxLexPA3si3ySZZF+jmG\nLqbbG8XuGgX+LZwFKehNaz03wN1LyA1isAIdiIaqvPay3FCzopkDAgMBAAGjODA2\nMAwGA1UdEwEB/wQCMAAwDgYDVR0PAQH/BAQDAgeAMBYGA1UdJQEB/wQMMAoGCCsG\nAQUFBwMCMA0GCSqGSIb3DQEBBQUAA4IBAQBgKQNqLTaKtRtJY2yvDOD06Y1SpraC\nHl/jhjK1Mavpv71I0lWQi1oOcmOM8VAmDvtKmDAGeWZPREJZUeOim1sBjE8tEEhJ\n6iyFPU3l1GBeCiWap7MTfefbsZ9nu1/WJD+H0WcP0YJsbFNxuMaQBXtEi5v9lIQT\nGc7EU8Pkp2CWaZQFkTkObK+Y9gDhCAm0I8RtVILfV4WnJ5GFc189EAFx8k26olYJ\nFD7fSjSmR8nQNO1clsymbz4EsNFL9m0QYBJL4h0nlaNCkEHgdMQmGQ9ld1bPpFt8\nQzrLrzHxy0Yx/c+mcAn/PVxMxer4AhGzQ6HdO/StU/jmIoj6w4QdC3jr\n-----END CERTIFICATE-----\n"
	}
	
	override getPubKey(String kid) { pubKeys.get(kid) }
}